services:
  api:
    build: .
    container_name: unichoice_api
    environment:
      PORT: 3000
      DATABASE_URL: ${DATABASE_URL}
      JWT_SECRET: "change-me"
      RUN_SEED: ${RUN_SEED}

      GOOGLE_CLIENT_ID: ""
      GOOGLE_CLIENT_SECRET: ""
      GOOGLE_CALLBACK_URL: ""

      GEMINI_API_KEY: ""
    ports:
      - "3000:3000"
    command: >
      sh -c "
      npx prisma migrate deploy &&
      if [ \"$RUN_SEED\" = \"true\" ]; then
        echo 'üå± Running Prisma seed...';
        npx prisma db seed;
      else
        echo '‚è≠Ô∏è Skipping seed';
      fi &&
      node src/server.js
      "
